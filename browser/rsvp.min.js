(function(e){"use strict";var t=typeof window!="undefined"?window:{},n="postMessage"in t&&(!t.document.documentMode||t.document.documentMode>=9),r;if(typeof process!="undefined"&&{}.toString.call(process)==="[object process]")r=function(e,t){process.nextTick(function(){e.call(t)})};else if(n){var i=[],s="drainQueue",o=function(e){if(e.source===t&&e.data===s){e.stopPropagation();var n=i.slice();i=[],n.forEach(function(e){var t=e[0],n=e[1];t.call(n)})}};t.addEventListener("message",o),r=function(e,n){i.push([e,n]),t.postMessage(s,"*")}}else r=function(e,t){setTimeout(function(){e.call(t)},1)};e.async=r;var u=e.Event=function(e,t){this.type=e;for(var n in t){if(!t.hasOwnProperty(n))continue;this[n]=t[n]}},a=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n][0]===t)return n;return-1},f=function(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t},l=e.EventTarget={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e},on:function(e,t,n){var r=f(this),i;n=n||this,i=r[e],i||(i=r[e]=[]),a(i,t)===-1&&i.push([t,n])},off:function(e,t){var n=f(this),r;if(!t){n[e]=[];return}r=n[e];var i=a(r,t);i!==-1&&r.splice(i,1)},trigger:function(e,t){var n=f(this),r,i,s,o,a;if(r=n[e])for(var l=0,c=r.length;l<c;l++)i=r[l],s=i[0],o=i[1],typeof t!="object"&&(t={detail:t}),a=new u(e,t),s.call(o,a)}},c=e.Promise=function(){this.on("promise:resolved",function(e){this.trigger("success",{detail:e.detail})},this),this.on("promise:failed",function(e){this.trigger("error",{detail:e.detail})},this)},h=function(){},p=function(e,t,n,r){var i,s;if(n)try{i=n(r.detail)}catch(o){s=o}else i=r.detail;i instanceof c?i.then(function(e){t.resolve(e)},function(e){t.reject(e)}):n&&i?t.resolve(i):s?t.reject(s):t[e](i)};c.prototype={then:function(e,t){var n=new c;return this.on("promise:resolved",function(t){p("resolve",n,e,t)}),this.on("promise:failed",function(e){p("reject",n,t,e)}),n},resolve:function(t){e.async(function(){this.trigger("promise:resolved",{detail:t}),this.isResolved=t},this),this.resolve=h,this.reject=h},reject:function(t){e.async(function(){this.trigger("promise:failed",{detail:t}),this.isRejected=t},this),this.resolve=h,this.reject=h}},l.mixin(c.prototype)})(window.RSVP={});
